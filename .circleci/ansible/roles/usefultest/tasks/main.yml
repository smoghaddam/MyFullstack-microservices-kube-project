---
- name: Setting environment variables for kubectl and getting cluster info
  shell: |
    newpath=$(awk '/PATH*:/ { if (!f) print $0; f = 1 }' .bash_profile)':/home/ec2-user/google-cloud-sdk/bin'
    sed -i '/PATH*:/c\'"$newpath" .bash_profile

- name: Supports a validate command
  ansible.builtin.replace:
    path: /home/ec2-user/.bash_profile
    regexp: '^PATH=*$'
    replace: '\1 127.0.0.1:8080'
    validate: '/usr/sbin/apache2ctl -f %s -t'